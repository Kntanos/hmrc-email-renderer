@*
* Copyright 2022 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@

@import play.api.libs.json.{JsArray, JsDefined, JsLookupResult, JsObject, JsUndefined, JsValue, Json, JsBoolean}

@(params: Map[String, Any])

@allItems = @{params("f2fPaymentItemsForEmailSuccessfu") match {
    case items:String => Json.parse(items).as[List[JsObject]]
    case _ => List()
}}

@itemList = @{ allItems.map( item => {

        val taxType: String = (item \ "taxType").as[String]
        val amount: String = (item \ "amount").as[String]
        val transactionFee: String = (item \ "transactionFee").as[String]
        val transactionNumber = (item \ "transactionNumber").as[String]
        val taxReference= (item \ "taxReference").as[String]
        (taxType, amount, transactionFee, transactionNumber, taxReference)
    })
}

@singleItem = @{itemList.size == 1}

@uk.gov.hmrc.hmrcemailrenderer.templates.helpers.html.template_main(params, "HMRC Payment confirmation") {

    <p style="font-size: 19px;line-height: 1.315789474;margin: 0 0 30px 0;">Dear Customer</p>


        <p style="margin: 0 0 30px; font-size: 19px;">Your payment has been received by HMRC.</p>


        <table width="100%" cellspacing="0" cellpadding="2px" style="text-align:left;font-size: 19px;">
            <tbody>
            @for((taxType, amount, transactionFee, transactionNumber, taxReference) <- itemList) {
            <tr>
                <th>Tax</th>
                <td>@taxType</td>
            </tr>
            <tr>
                <th>Tax Reference</th>
                <td>@taxReference</td>
            </tr>
            <tr>
                <th>Payment reference</th>
                <td>@transactionNumber</td>
            </tr>
            <tr>
                <th>Amount</th>
                <td>@amount</td>
            </tr>
            <tr>
                <th>Card fee</th>
                <td>@transactionFee</td>
            </tr>
            }
            <tr>
                <th>Card details</th>
                <td>Paid with @params("cardType"), ending in @params("cardNumber")</td>
            </tr>
            <tr>
                <th>Transaction Reference</th>
                <td>@params("transactionReference")</td>
            </tr>
            <tr>
                <th>Total paid</th>
                <td>Â£@params("totalAmountPaid")</td>
            </tr>
            <tr>
                <th>Date</th>
                <td>@params("dateOfPayment")</td>
            </tr>
            </tbody>
        </table>


    <p style="margin: 0 0 30px; font-size: 19px;">If you have an online tax account your payment will take 3 to 5 days to show in your account.</p>

    <h2  style="margin: 0 0 30px; font-size: 19px;">Why you got this email</h2>

    <p style="margin: 0 0 30px; font-size: 19px;">You chose to receive payment confirmation by email.</p>

    <p style="margin: 0 0 30px; font-size: 19px;">From HM Revenue and Customs</p>

}
